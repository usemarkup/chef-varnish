# Primitive user agent shield against unattended bots, often very affective though unless a target attack occurs

sub recv_shield {
    # Allow bots for XML & JSON
    if (req.restarts == 0 && req.url !~ "(xml|json)$") {
      if (
        req.http.user-agent ~ "^Java"
          || req.http.user-agent ~ "^Apache"
          || req.http.user-agent ~ "YandexBot"
          || req.http.user-agent ~ "Scrapy"
          || req.http.user-agent ~ "deepcrawl"
          || req.http.user-agent ~ "SearchmetricsBot"
          || req.http.user-agent ~ "archive.org_bot"
          || req.http.user-agent ~ "AhrefsBot"
          || req.http.user-agent ~ "SemrushBot"
          || req.http.user-agent ~ "SurdotlyBot"
          || req.http.user-agent ~ "VeBot"
          || req.http.user-agent ~ "DotBot"
          || req.http.user-agent ~ "diffbot"
          || req.http.user-agent ~ "IDBot"
          || req.http.user-agent ~ "id-search"
          || req.http.user-agent ~ "User-Agent"
          || req.http.user-agent ~ "ConveraCrawler"
          || req.http.user-agent ~ "^Mozilla$"
          || req.http.user-agent ~ "libwww"
          || req.http.user-agent ~ "lwp-trivial"
          || req.http.user-agent ~ "curl"
          || req.http.user-agent ~ "PHP/"
          || req.http.user-agent ~ "urllib"
          || req.http.user-agent ~ "GT:WWW"
          || req.http.user-agent ~ "Snoopy"
          || req.http.user-agent ~ "MFC_Tear_Sample"
          || req.http.user-agent ~ "HTTP::Lite"
          || req.http.user-agent ~ "PHPCrawl"
          || req.http.user-agent ~ "URI::Fetch"
          || req.http.user-agent ~ "Zend_Http_Client"
          || req.http.user-agent ~ "http client"
          || req.http.user-agent ~ "PECL::HTTP"
          || req.http.user-agent ~ "panscient.com"
          || req.http.user-agent ~ "IBM EVV"
          || req.http.user-agent ~ "Bork-edition"
          || req.http.user-agent ~ "Fetch API Request"
          || req.http.user-agent ~ "PleaseCrawl"
          || req.http.user-agent ~ "Pcore-HTTP"
          || req.http.user-agent ~ "^python-requests"
          || req.http.user-agent ~ "^bl.uk_lddc_bot"
          || req.http.user-agent ~ "^IAS crawler"
          || req.http.user-agent ~ "^YisouSpider"
          || req.http.user-agent ~ "^Screaming"
          || req.http.user-agent ~ "^Ruby"
          || req.http.user-agent ~ "^Go-http-client"
          || req.http.user-agent ~ "^WordPress"
          || req.http.user-agent ~ "^Typhoeus"
          || req.http.user-agent ~ "^rogerbot"
          || req.http.user-agent ~ "^Instart"
          || req.http.user-agent ~ "Baiduspider"
          || req.http.user-agent ~ "mj12bot"
          || req.http.user-agent ~ "shopstyle"
          || req.http.user-agent ~ "GarlikCrawler"
          || req.http.user-agent ~ "omgili"
          || req.http.user-agent ~ "RU_Bot"
          || req.http.user-agent ~ "muhstik"
      ) {
        return (synth(403));
      }
    }
}
